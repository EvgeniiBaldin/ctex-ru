%  -*- coding: koi8-r -*-
\chapter{Всё о таблицах}
\label{cha:table}


{\setlength{\epigraphwidth}{0.52\textwidth} \epigraph{Я над ней, может
    быть, двадцать лет думал, а вы думаете: сидел и вдруг\ldots
    готово.}{\emph{Комментарий Д.\,И.~Менделеева к легенде о~том, что 
    периодическая таблица элементов ему якобы приснилась.}}}




Далеко не всякое содержание следует облекать в форму таблицы. 
Но для~малых объёмов однородных значимых данных таблицы бывают лучшим
способом отображения.

Таблица "--- это особая форма передачи содержания.  Таблица "--- 
один из самых сложных текстовых элементов. Сложных не в том смысле,
что её сложно оформлять "--- сложно добывать для неё подходящие
данные. Очень легко сделать бессмысленную таблицу. Слишком много
информации не оставит по прочтению никакого следа. Всегда надо думать,
как и что представлять, но хорошая таблица стоит тысячи слов.



\section{Немного теории}
\label{sec:tables:theory}


Честно говоря, описание таблиц с помощью \LaTeX-разметки может
показать не очень удобным. Действительно, когда вперемешку идут данные
и управляющие структуры, исходник таблицы может выглядеть не очень красиво.
Спасает только то, что большие таблицы с однородной структурой можно
создавать с~помощью скрипта, а маленькие таблицы не являются особой
проблемой. Как правило, гораздо больше времени, чем оформление таблицы,
занимает поиск и верификация данных.



Содержимое таблицы организуется в колонки (графы) и горизонтальные
строки таким образом, что каждый элемент является составной частью как
строки, так колонки. Таблица состоит из следующих основных элементов:
нумерационного и тематического заголовков (номер таблицы и её
название), головки\footnote{В <<Издательском словаре-справочнике>>
  А.\,Э.~Мильчина \cite{Milchin-2003} утверждается, что попытка замены
  этого термина по той причине, что он якобы является жаргонным, не
  привилась.} (заголовочная часть таблицы), хвоста (вся остальная
часть таблицы без головки), боковика (первая слева графа таблицы) и
прографки (хвостовая часть таблицы без боковика).



\begin{table}[h]
%begin{example}{struct}
\hfill\hfill
  \begin{tabular}{c}
    \begin{tabular}{|p{1.8cm}|p{1.8cm}p{1.8cm}|p{2.3cm}}
    \multicolumn{1}{c}{\textbf{Боковик}}&\multicolumn{2}{c}{\textbf{Прографка}} \\[2mm]\cline{1-3}
     \textbf{\ ИЛИ} & Истина & Ложь &\quad\text{\textbf{Головка}}\\\cline{1-3}
    \end{tabular}\\
    \begin{tabular}{|p{1.8cm}|p{1.8cm}p{1.8cm}|p{2.3cm}}
    Истина & Истина & Истина  & \multirow{2}{2.3cm}{\quad \textbf{Хвост}} \\
    Ложь   & Истина & Ложь &\\\cline{1-3}
    \end{tabular}
  \end{tabular}\hfill
    
\centering
%end{example}
  \caption{Структура таблицы}
  \label{tab:tables:struct}
\end{table}


Заполняя таблицу текстовыми или цифровыми данными, полезно следовать
правилам.
\begin{itemize}
\item Выносить данные,  общие для каждого элемента графы, в её заголовок,
  а общие для каждого элемента строки "--- в заголовок боковика.
\item По возможности употреблять числа не более чем из четырёх
  значащих цифр. Для этого более многозначные числа следует округлять.
  Общий множитель следует вынести в заголовок. То же самое нужно
  сделать и с единицами измерения.
\item Всегда перед знаком, отделяющим целую часть числа от дробной,
  должна быть цифра. То есть правильно писать <<\(0.1\)>>, но не
  <<\(.1\)>>.
\item Проставлять вместо отсутствующих данных многоточие <<\ldots>>,
  <<Нет свед.>>. Если данных в принципе быть не может, то лучше
  отметить это с помощью тире <<--->>.
\item Не следует использовать знаки, означающее <<то же, что и
  предыдущее значение>>. Лучше повторить число.
\end{itemize}



\section{tabbing}
\label{sec:tables:tabbing}

Если точно известна ширина столбцов, и таблица относительно простая, то
можно воспользоваться окружением \textenv{tabbing}.

\begin{example}{tabbing}
\begin{tabbing}
MMMMM  \= MMMMM \=     \kill 
\textbf{\ ИЛИ} \> Истина \> Ложь  \\
Истина \> Истина \> Истина \\
Ложь   \> Истина \> Ложь 
\end{tabbing}  
\end{example}
Первая строчка устанавливает положение табуляторов с помощью команды
\lstinline!\=!. Команда \textcmd{kill}, завершающая управляющую
строку, даёт понять текстовому процессору, что её не надо печатать.
Далее идёт обычный текст, где переход к~следующей табуляции
осуществляется с помощью команды \lstinline!\>!, а перевод строки
завершается комбинацией \lstinline!\\!. Всё просто "--- точно так же
таблицы печатали с~помощью обычной печатной машинки, только табуляция
задавалась <<железным>>, а не программным способом.

К использованию окружения \textenv{tabbing} следует подходить с
известной долей осторожности. Окружение формирует абзац, состоящий из
отдельных строк, в~котором нет места переносам и многострочным
элементам. Зато это позволяет \LaTeX{} легко переносить часть таблицы
на следующую страницу. Абсолютно всё приходится делать своими руками,
но в этом есть своеобразная прелесть. Часто \textenv{tabbing}
становится базой для определения других более специализированных
окружений.

Некоторые стандартные команды \LaTeX{} внутри \textenv{tabbing}
переопределены. Это в~частности касается команд переноса
(\lstinline{\-}) и акцентирования (\lstinline!\'! и \lstinline!\`!).
Для сохранения/воспроизводства текущей табуляции следует
воспользоваться командами \textcmd{pushtabs}/\textcmd{poptabs}.

\section{tabular и array}
\label{sec:tables:tabular}

Самым популярным окружением для отображения таблиц в \LaTeX{} является
\textenv{tabular}. Окружение \textenv{array} фактически полностью
повторяет функционал \textenv{tabular}, но в отличии от последнего
работает в математической моде "--- полезно для создания матриц,
которые по своей сути тоже обычные таблицы.
\begin{example}[0.6\linewidth]{tabular-1}
\centering
\begin{tabular}[c]{l|ll}
\textbf{\ ИЛИ} & Истина & Ложь \\[2mm]\hline
Истина & Истина & Истина \\
Ложь   & Истина & Ложь
\end{tabular}
\end{example}
Данные делятся на ячейки с помощью символа <<логическое И>> или конъюнкции
"--- \lstinline!&! . Переход на следующую строку контролируется стандартной
командой переноса строки \lstinline!\\!. В качестве необязательного
параметра команды переноса строки можно указать дополнительный сдвиг
по вертикали. Вертикальный размер каждой из строк автоматически
выставляется в соответствии с высотой текста.

\textenv{tabular} создаёт единый объект "--- таблицу. Как и в случае
картинок  таблицу удобно заключать в плавающее окружение \textenv{table}:
\begin{lstlisting}
\begin{table}[ht]
  \centering% центрируем таблицу
   \begin{tabular}[|<<позиционирование таблицы>>|]{|<<формат столбцов>>|}
     |<<тело таблицы>>|
   \end{tabular}  
 \caption{|<<подпись>>|}\label{tab:metka}
\end{table}

\end{lstlisting}
Это позволяет автоматически создать нумерационный заголовок таблицы и
добавить тематический. Необязательный аргумент окружения
\textenv{tabular} даёт возможность указать, как позиционировать всю таблицу по
вертикали по отношению к~окружающему тексту:
\begin{eqlist*}
\item[\textbf{t}] "--- выравнивание по верхней строке, то есть верхняя строка
  таблицы будет расположена на одном уровне со строкой, где эта таблица размещена;
\item[\textbf{c}] "--- выравнивание по центру;
\item[\textbf{b}] "--- выравнивание по нижней строке.
\end{eqlist*}

Ширина столбцов вычисляется автоматически по заданному формату,
который задаётся через обязательный аргумент окружения. Каждому из
столбцов должна соответствовать своя буква:
\begin{eqlist*}
\item[\textbf{l} (left)]  "--- выравнивание по левому краю;
\item[\textbf{c} (center)]  "--- выравнивание по центру;
\item[\textbf{r} (right)]  "--- выравнивание по правому краю;
\longitem[\textbf{p}\{<<ширина>>\}] "--- задание колонки определённой ширины. В случае
  жёстко заданной длины слишком длинный текст может разбиваться на
  несколько строк.
\end{eqlist*}

Если формат столбцов повторяется, то для сокращения записи можно
воспользоваться следующей спецификацией:
\begin{lstlisting}
*{n}{|<<формат столбца или столбцов>>|}

\end{lstlisting}
Где n "--- число повторений. Такой вот своеобразный цикл.
\begin{example}{tabular-2}
\centering
\begin{tabular}{|*{3}{c|}}
\textbf{ИЛИ} & Истина & Ложь \\[2mm]
 \hline\hline
Истина & Истина & Истина \\
Ложь   & Истина & Ложь
\end{tabular}
\end{example}

Разделительные линии между столбцами задаются с помощью вертикальной
черты~\lstinline!|!. Две вертикальные линии \lstinline!||!формируют
двойной разграничитель. Горизонтальные линии создаются с помощью
команды \textcmd{hline}. По аналогии с двойной вертикальной чертой
две команды формируют двойную горизонтальную линию. Инструкция
\lstinline!@{}! позволяет вставить между столбцами любой символ,
указанный в качестве обязательного аргумента. При этом подавляются
околостолбцовые промежутки, добавляемые по умолчанию автоматически.
Это может быть полезно в случае, если один столбец представляет собой
какую-то измеренную величину, а второй "--- её ошибку, тогда
вместо разделительной черты между ними лучше вставить знак \(\pm\).
\begin{example}{tabular-3}
\centering
\begin{tabular}{c||p{2cm}@{$\pm$\ }r|}
\textbf{ИЛИ} & Истина & Ложь \\[2mm]
 \cline{2-3}
Истина & Истина & Истина \\ 
\cline{1-1}\cline{3-3}
Ложь   & Истина & Ложь\\ \cline{2-2}
\end{tabular}
\end{example}
Для того чтобы отчеркнуть только часть столбцов, можно воспользоваться
командой \lstinline!\cline{диапазон столбцов}!. 

Стилевой файл \textpkg{array} из коллекции \textpkg{tools} в
дополнение к стандартным типам столбцов, используемых в
\textenv{tabular}, добавляет два новых: 
\smallskip

\begin{eqlist*}
\item[\textbf{m\{<<ширина>>\}}] "--- то же, что и \textbf{p\{<<ширина>>\}}, но
  добавляется вертикальное выравнивание содержимого таблицы по центру
  этой клетки;
\item[\textbf{b\{<<ширина>>\}}] "--- то же, что и \textbf{m\{<<ширина>>\}}, но
  вертикальное выравнивание содержимого идёт по нижней базовой линии
  последней строки.
\end{eqlist*}

Более подробную информацию о дополнительных настройках,
предоставляемых стилем \textpkg{array},
следует искать в файле документации \textfile{array.pdf}.


В окружении \textpkg{tabular} можно использовать подстрочное
примечание. При этом примечание формируется не внизу страницы, а рядом с
самой таблицей:
\begin{example}[0.6\textwidth]{tabular-4}
\centering
\begin{tabular}{r}\hline\hline
Пример\footnote{подстрочного примечания}.\\
\hline\hline
\end{tabular}
\end{example}



\Note Подробнее о том, как \emph{должна} выглядеть таблица и как это
достигается, можно узнать, например, в статье <<Publication quality
tables in \LaTeX>> (\textfile{booktabs.pdf}), написанной Симоном Фиром
(Simon Fear) для пакета \textpkg{booktabs}. Этот пакет для~тех, кто
везде любит наводить лоск.

\subsection{Подписи к таблицам}
\label{sec:tables:caption}

Создание подписей к таблицам ничем не отличается от создания подписей
к~рисункам (см. раздел~\ref{sec:graphics:caption}). Но в отличие от
рисунка, где подпись традиционно выставляется под ним, подпись для
таблицы часто лучше размещать сверху. Это связано, например, с
тем, что в тексте могут встречаться многостраничные таблицы.


\begin{figure}[t]
%  \centering

  \hfill
  \includegraphics[width=0.45\textwidth]{tables/tables-notopcaption}\hfill
  \includegraphics[width=0.45\textwidth]{tables/tables-topcaption}\hfill\ 

  \hfill
  \parbox{0.4\textwidth}{\caption{\textcmd{caption} размещается до
      таблицы без поправок}\label{fig:tables:topcaption}}\hfill
  \parbox{0.4\textwidth}{\caption{Используется команда
      \textcmd{topcaption} из пакета
      \textpkg{topcapt}}\label{fig:tables:notopcaption}}\hfill\ 
\end{figure}


Для размещения подписи над таблицей проще всего воспользоваться
пакетом \textpkg{topcapt}, в котором определяется команда
\textcmd{topcaption},  полностью эквивалентная \textcmd{caption}:
\begin{lstlisting}
\begin{table}[ht]
 \topcaption{|<<подпись>>|}\label{tab:metka}
 \begin{tabular}
        |\ldots|
 \end{tabular}  
\end{table}

\end{lstlisting}

Необходимость использования пакета \textpkg{topcapt} объясняется тем,
что в случае применения \textcmd{caption} используются неправильные
вертикальные промежутки между подписью и
таблицей. Рисунки~\ref{fig:tables:topcaption}
и~\ref{fig:tables:notopcaption} позволяют почувствовать разницу. Того
же эффекта можно добиться, просто переопределив значения для~вертикальных
промежутков:
\begin{lstlisting}
\begin{table}
 \setlength{\abovecaptionskip}{0pt}
 \setlength{\belowcaptionskip}{10pt}
 \caption{|<<подпись>>|}\label{tab:metka}
 \begin{tabular}
        |\ldots|
 \end{tabular}  
\end{table}
\end{lstlisting}

\subsection{К вопросу о разделительных линиях}
\label{sec:tables:lines}

По характеру оформления линейками таблицы бывают закрытые (глухие),
полузакрытые, открытые. Два настоятельных совета:
\begin{itemize}
\item никогда не следует использовать вертикальные линии в таблице;
\item двойные линии в оформлении таблицы также лишние.
\end{itemize}

Если данные в таблице настолько разные, что хочется их поделить
вертикальной линией, то лучше сделать две таблицы. Но опять же никто
не может запретить использовать разделительные линии.

Стиль \textpkg{hhline} из коллекции \textpkg{tools} определяет команду
\textcmd{hhline}, которая позволяет управлять созданием двойной
рамки, не создавая ненужных пересечений. Подробности в документации
\textpkg{hhline.pdf}.
Пакет \textpkg{arydshln} необходим в случае использования пунктирных
разделительных линий. Документация к этом пакету
\textfile{arydshln-man.pdf} более чем исчерпывающая.

\subsubsection{cellspace}
Иногда при формировании таблицы разделительные линии наезжают на
текстовое содержание:
\begin{example}{cellspace-1}
\begin{tabular}{c}\hline
 $\displaystyle
e = 1+\frac{1}{2}+\frac{1}{6}+\cdots
 + \frac{1}{k!} + \cdots $ \\\hline
\end{tabular}
\end{example}
Обойти эту проблему поможет пакет \textpkg{cellspace}. В пакете
доопределены дополнительные форматы колонок, при использовании которых
гарантируется, что всегда останется небольшой промежуток между линией
и текстом:
\begin{example}{cellspace-2}
\begin{tabular}{Sc}\hline
 $\displaystyle
e = 1+\frac{1}{2}+\frac{1}{6}+\cdots
 + \frac{1}{k!} + \cdots $ \\\hline
\end{tabular}
\end{example}
Вместо форматов колонок \textopt{l}, \textopt{c} и \textopt{r} следует
использовать \textopt{Sl}, \textopt{Sc} и \textopt{Sr}
соответственно. Все другие форматы должны определяться внутри формата
\textopt{S}, например, \textopt{S\{p\{3cm\}\}}.



\subsection{Клетки}
\label{sec:tables:tuples}


Для объединения  расположенных рядом по горизонтали клеток можно
воспользоваться командой 
\textcmd{multicolumn}\lstinline!{n}{формат колонки}{текст}!,
а для объединения по вертикали: 
\textcmd{multirow}\lstinline!{n}{высота}{текст}! из 
одноимённого пакета.\textpkgh{multirow}

Пример использования \textcmd{multicolumn}:
\begin{example}{tabular-4}
\centering
\begin{tabular}{|*{3}{c|}}
\textbf{ИЛИ} & Истина & Ложь \\[2mm]
 \hline\hline
Истина & \multicolumn{2}{c|}{Истина} \\
Ложь   & Истина  & Ложь
\end{tabular}
\end{example}
Первый обязательный параметр соответствует числу объединённых колонок,
второй "--- формату получившейся объединённой колонки, третий "--- тексту.

Пример использования \textcmd{multirow} из пакета \textpkg{multirow}:
\begin{example}[0.6\linewidth]{tabular-5}
\centering
\begin{tabular}{|*{3}{p{1cm}|}}
\textbf{ИЛИ} & Истина & Ложь \\[2mm]
 \hline\hline
Истина & \multirow{2}{1cm}{Истина} & Истина \\
Ложь   &                            & Ложь
\end{tabular}
\end{example}
Подробнее об использовании команд пакета написано в \textfile{README}
к нему. В пакете определены две команды с двумя и тремя обязательными
аргументами:
\begin{lstlisting}
\multirow{|<<число строк>>|}{|<<ширина>>|}{|<<текст>>|} 
\multirow{|<<число строк>>|}*{|<<текст>>|}

\end{lstlisting}
В качестве первого аргумента передаётся число строк, которые займёт
объединённая клетка, далее можно выбрать либо автоматическое
вычисление ширины, либо указать её самостоятельно. Число строк может
быть отрицательным. В этом случае объединяются ячейки сверху от
команды. Подобное может потребоваться, чтобы согласовать свою работу с
пакетом  \textpkg{colortbl}:
\smallskip

\noindent
\textcmdhemph{rowcolor}
\textcmdhemph{columncolor}
\includegraphics{tables/tables-slashbox}
% \begin{example}[0.55\linewidth]{tabular-6}
% \centering % при цветной печати будет цвет
% \begin{tabular}{c>{\columncolor{yellow}}cc} 
% \backslashbox{два}{один} & Истина & Ложь \\
% \rowcolor{yellow}
% Истина &                        & Истина \\
% Ложь   & \multirow{-2}*{Истина} & Ложь
% \end{tabular}  
% \end{example}

Пакет  \textpkg{colortbl} предназначен для раскрашивания таблицы в
разные цвета. В~документации \textfile{colortbl.pdf} подробно
излагаются принципы работы пакета.

Команда \textcmd{backslashbox}\lstinline!{текст}{текст}!, делящая
клетку на~две части наклонной чертой, определена в пакете
\textpkg{slashbox} (пакет необходимо скачать с CTAN и
самостоятельно  установить). Иногда так оформляют клетку на~перекрестии
боковика и головки. С пакетом идёт пример \textfile{slashbox.tex}.


Автор кириллических шрифтов \textpkg{lh} Ольга Лапко для более
изощрённой работы с таблицами предлагает пакет \textpkg{makecell}. В
этом пакете определена команда \textcmd{makecell}, которая <<создаёт
окружение одноколоночной таблицы с предопределёнными общими
параметрами выключки, интерлиньяжа и вертикальных отбивок вокруг. Её
удобно использовать для многострочных ячеек. Дополнительный аргумент
команды позволяет изменить выключку таблицы>>. В пакете 
документация на английском языке (\textfile{makecell.pdf}) дублируется
русской документацией (\textfile{makecell-rus.tex}). 

\subsection{Выравнивание чисел}
\label{sec:tables:numbercentering}
Таблица часто строится вокруг чисел. Поэтому не удивительно, что
внимание к выравниванию чисел для целей упрощения восприятия данных
должно быть повышенным.

\mindex{выравнивание чисел}

Пакет \textpkg{dcolumn} из коллекции \textpkg{tools} добавляет ещё
одну спецификацию к формату столбцов таблицы:
\bigskip

\begin{examplenv}{tabular-7}
\centering
\begin{tabular}{|c|l|D{.}{,}{5}|} 
0.3141 & 0.3141 & 0.3141 \\
3.141  & 3.141  & 3.141 \\
31.415 & 31.415 & 31.41 \\
\end{tabular}  
\end{examplenv}
\bigskip

Новая спецификация имеет формат: \lstinline!D{delim}{output}{nfruc}!,
где delim "--- символ или набор символов, по которому происходит
выравнивание (обычно это точка или запятая), output "--- символ,
который замещает delim при компиляции (например, бывает нужно заменить
точку на запятую), nfrac "--- максимальное число позиций в дробной
части числа (при отрицательном значений число позиций не
фиксируется). Подробности в документации \textfile{dcolumn.pdf}.


Пакет \textpkg{numprint} (документация \textfile{numprint.pdf}) можно
использовать просто для внятной печати чисел. Одноимённая команда
\textcmd{numprint} позволяет легко переводить текстовую запись в
математическую:
\bigskip

\begin{examplenv}[0.6\textwidth]{numprint-1}
\numprint[\text{м}/\text{с}]{299792458}\par
\numprint{2.718281828459045}\par
\numprint{6e23}\par
\numprint{+-0.02}
\end{examplenv}
\bigskip

Следует обратить внимание на то, как формируется запись числа "---
каждые три следующие цифры целой или дробной части разделяются
небольшим пробелом. В пакете \textpkg{numprint} определён формат
\textopt{n} с двумя параметрами для выравнивания чисел. Первый
параметр указывает, сколько места следует оставить для~цифр целой
части, а второй "--- для цифр дробной части.

Использование \textopt{n}"=формата  из пакета \textpkg{numprint}:
\medskip

\begin{examplenv}[0.6\textwidth]{numprint-2}
\centering
\begin{tabular}{|n{3}{4}|n{2}{3}|n{1}{2}|} 
0.3141 & 0.3141 & 0.3141 \\
3.141  & 3.141  & 3.141 \\
31.41 & 31.41 & 31.41 \\
314.1 & 314.1 & 314.1 \\
\end{tabular}  
\end{examplenv}
\medskip

Пакет \textpkg{rccol} обладает схожей функциональностью, что и
\textpkg{dcolumn}, но дополнительно позволяет округлять значения.  К
сожалению, мне не удалось заставить его нормально работать, если в
качестве разделителя используется точка. \textpkg{rccol}, несмотря на
информацию в документации \textfile{rccol.pdf}, признаёт только
запятую. Возможно, это недоразумение.

Пакет \textpkg{warpcol} предоставляет общую процедуру формирования
формата числовых колонок. В документации к пакету
\textfile{warpcol.pdf} представлены примеры того, как добиться различных
эффектов при выравнивании.



\subsection{Доступ к данным}
\label{sec:tables:data}

CSV (от англ. Comma Separated Values "--- значения, разделённые запятыми)
"--- это текстовый формат, предназначенный для представления табличных
данных. Для доступа к этим данным напрямую можно воспользоваться
пакетом \textpkg{csvtools}. Документация к пакету
\textfile{csvtools.pdf} достаточно подробна, но лучше осуществлять
доступ к данным
 с помощью скрипта, результатом действия которого является
сам tex-файл.


\subsection{Клоны tabular}
\label{sec:tables:tabularclones}

\textpkg{tabularx} из коллекции \textpkg{tools} "--- расширение
\textenv{tabular} на предмет автоматического вычисления ширины
колонок, имеющих форматный определитель \lstinline!X!.  
\textenvh{tabularx}
\medskip

\begin{examplenv}[0.6\textwidth]{tabularx}
\centering
\begin{tabularx}{\textwidth}{|D{.}{,}{4}|X|c|} 
0.3141 & очень длинная строка  & 0.3141 \\
3.141\footnote{В окружение tabularx можно 
добавлять подстрочное примечание}  
 & 3.141  & 3.141 
\end{tabularx}  
\end{examplenv}
\medskip

В качестве первого аргумента окружения \textenv{tabularx} передаётся
ширина таблицы.  При компиляции \lstinline!X! преобразуется в
\lstinline!p{ширина}!, где вместо ширины выставляется автомататически
вычисленная величина так, чтобы в целом ширина таблицы оставалась
неизменной. Если в таблице присутствует более одного столбца, имеющих
формат \lstinline!X!, то для формирования таблицы может потребоваться
несколько проходов. Все подробности, как обычно, можно узнать в
документации к пакету (\textfile{tabularx.pdf}).

Пакет \textpkg{tabulary} также является модификацией стиля
\textpkg{tabular}, точнее \textpkg{array}. Пакет был создан для
автоматического расчёта ширины колонок таблицы с целью минимизации
высоты таблицы. Подробности можно найти в документации к пакету
\textfile{tabulary.pdf}. Пользоваться одноимённым окружением следует с
некоторой долей осторожности.

\textpkg{ctable} представляет из себя альтернативный взгляд на оформление таблицы. Для
описания структуры таблицы вместо
окружения используется команда \textcmd{ctable}, которая объединяет
в себе функциональность \textpkg{tabular} и \textpkg{table}. В
дополнение к этим особенностям в~\textcmd{ctable} можно вставлять
команды для создания подстрочных примечаний для~таблицы. Примеры и
документацию к пакету можно найти в файле \textfile{ctable.pdf}.

\section{Многополосные таблицы}
\label{sec:tables:placement}

Окружение \textpkg{tabular} и его производные всем хороши за
исключением того, что они не могут занимать больше одной страницы. 

Для вёрстки таблиц на несколько страниц обычно используют одно из двух
окружений: \textenv{supertabular} и \textenv{longtable}, определённых
в одноимённых стилях. \textpkgh{supertabular} \textpkgh{longtable} 
Оба эти окружения обладают схожей
функциональностью, но разными способами оформления. Оба предоставляют
возможность создания стандартных шапки и окончания,
появляющихся в начале, на каждой новой странице и в~конце таблицы, соответственно.
Про использование этих пакетов  можно прочитать в~документации:
\textfile{supertabular.pdf} для \textenv{supertabular} и
\textfile{longtable.pdf} для \textenv{longtable} из~коллекции
\textpkg{tools}.

\textenv{longtable} в отличии от \textenv{supertabular} гарантирует
неизменность ширины столбцов на протяжении всей таблицы, что
достигается за несколько проходов \LaTeX.  Неизменность ширины столбцов в
зависимости от ситуации может рассматриваться как преимущество, так и
как недостаток.

В пакете \textpkg{supertabular} кроме окружения \textenv{supertabular}
определено окружение \textenv{mpsupertabular}, которое каждый
отдельный кусок таблицы на своей странице заключает в окружение
\textenv{minipage}, что позволяет использовать подстрочные примечания
прямо в таблице.

\subsubsection{xtab}
\label{sec:xtab}

Более молодым и, возможно, более правильным является пакет
\textpkg{xtab}. По сути дела это расширение \textpkg{supertabular} с
некоторыми улучшениями и исправлениями. Также в пакете \textpkg{xtab}
определено окружение \textenv{mpxtabular}, которое отличается 
от~\textenv{xtabular} тем, что каждая страница предварительно заключается
в окружение \textenv{minipage}, что позволяет создавать подстрочные
примечания, которые выводятся в конце страницы.

Код для создания длинной таблицы с помощью \textpkg{xtab} выглядит
примерно следующим образом: \textenvh{xtab}
\begin{lstlisting}[escapechar=+]
% Основной заголовок - печатается только в начале
\topcaption{Заголовок таблицы} \label{tab:xtab}

% Основная головка - печатается только в начале
\tablefirsthead{\hline Левая колонка & Правая колонка\\\hline}

% Вспомогательный заголовок и головка - печатается на 
%каждой новой странице кроме последней
\tablehead{\multicolumn{2}{c}%
           {\tablename\ \thetable{} "--- продолжение}\\
  \hline   Левая колонка & Правая колонка\\ \hline}

% Вспомогательный заголовок и головка - печатается на
%последней странице 
\tablelasthead{\multicolumn{2}{c}%
           {\tablename\ \thetable{} "---  окончание}\\
  \hline   Левая колонка & Правая колонка\\ \hline}

% Код завершения страницы при переносе на следующую
\tabletail{\hline \multicolumn{2}{|r|}%
           {Продолжение на следующей странице}\\ \hline}

% Заключительный код
\tablelasttail{\hline}

\begin{center}
\begin{xtabular}{|l|p{0.5\textwidth}|}
xtabular  &  Это расширение обычного окружения tabular. 
             Все команды+,+ которые могут работать в окружении
             tabular+,+ работают и в xtabular\\

        +\ldots+
\\
\end{xtabular}
\end{center}
\end{lstlisting}

Подробная документация, как обычно, доступна в файле
\textfile{xtab.pdf}.


\section{Вывод}
\label{sec:tables:nolines}


Вывод "--- таблица без линеек или организованный в колонки и строки
материал, который не разделён линейками. Оглавление
\textcmd{tableofcontents}, списки иллюстраций
\textcmd{listoffigures} и таблиц \textcmd{listoftables} тоже
являются таблицами.
\begin{example}{tabular-8}
\centering
\begin{tabular}{p{0.7\textwidth}@{}r} 
Глава 1\dotfill & 2 \\
Глава 2\dotfill & 10 \\
Глава 3\dotfill & 124 
\end{tabular}  
\end{example}
Команда \textcmd{dotfill} формирует \emph{отточия} (заполнение
пространства точками).

\subsubsection{listliketab}
\label{sec:listliketab}

Окружение \textenv{listliketab} из одноимённого пакета
специализируется на создании таблиц, оформленных как перечисление.
Это окружение будет очень кстати при~оформлении вопросников:
\textpkgh{listliketab}

\begin{lstlisting}
\storestyleof{enumerate}
\begin{listliketab}
 \newcounter{tabenum}\setcounter{tabenum}{0}
 \newcommand{\nextnum}{\addtocounter{tabenum}{1}\thetabenum.}
 \begin{tabular}{L>{\bf}l@{~~или~~}>{\bf}l@{~~или~~}>{\bf}l}
 \nextnum & Красный   & зелёный & голубой \\
 \nextnum & Низкий & средний & высокий \\
 \nextnum & Радостный & грустный   & удивлённый \\
 \end{tabular}
\end{listliketab}

\end{lstlisting}
 Команда \textcmd{nextnum} используется для оформления нумерованных списков.
\bigskip

Результат выполнения кода:

%begin{example}{listliketab}
%precommand  \newcounter{tabenum}\setcounter{tabenum}{0}
\storestyleof{enumerate}
\begin{listliketab}
 \newcommand{\nextnum}{\addtocounter{tabenum}{1}\thetabenum.}
 \begin{tabular}{L>{\bf}l@{~~или~~}>{\bf}l@{~~или~~}>{\bf}l}
 \nextnum & Красный   & зелёный & голубой \\
 \nextnum & Низкий & средний & высокий \\
 \nextnum & Радостный & грустный   & удивлённый \\
 \end{tabular}
\end{listliketab}
%end{example}

Документация с примерами находится в файле \textfile{listliketab.pdf}
%\newpage

\section{И это тоже таблицы?}
\label{sec:tables:another}

Пакеты \textpkg{tableaux} и \textpkg{tabvar} созданы для исследования
области определения и поведения функции. 

\Note Пригодится при изучении или
написании методички по началам матанализа.  Молодцы французы!
%begin{example}{tabvar}
\[\begin{tabvar}{|C|CCCCCCCCC|} \hline                                          
 x    &-\infty &   &-\sqrt[3]{2} &   & 0       &   & 1  &    &+\infty           
\\ \hline                                                                       
f'(x) &        & - &             & - & \dbarre & - & 0  & +  &                  
\\ \hline                                                                       
\niveau{3}{3}f(x)                                                               
      &+\infty                       &\decroit                                  
      &0                             &\decroit                                  
      &\discont{-\infty}{<}{+\infty} &\decroit                                  
      &\frac{3}{2}                   &\croit                                    
      &+\infty                                                                  
\\ \hline                                                                       
\end{tabvar}\] 
%end{example}
\textpkg{tabvar} является более современной версией стиля
\textpkg{tableaux}.  Поэтому подробности и примеры лучше всего искать в
его документации \textfile{tabvar.pdf} и \textfile{demo.tex}.
\medskip

Следующий пример оформляется вовсе не как таблица, но что-то
<<табличное>> в нём есть.  Пакет \mbox{\textpkg{pb-diagram}}
пригодится, когда нужно нарисовать простенькую диаграмму:
%begin{example}{pg-diagram}
\begin{equation*}
\begin{diagram}
     \node{\psi'} \arrow{e,tb,V}{9.3\%}{\sim65\,\text{тыс.}}  \node{\chi_{c0} \gamma}
     \arrow{s,r,J}{6.6\cdot10^{-3}} 
     \arrow{e,tb,V}{\sim6\cdot10^{-4}}{\sim420} \node{J/\psi\gamma\gamma}
     \arrow{s,r,J}{12\%} \arrow{e,tb,V}{\sim7\cdot10^{-5}}{\sim50} 
     \node{\lele\gamma\gamma}\\
     \node[2]{J/\psi \gamma} \node{\lele} 
\end{diagram}\label{eq:pg-diagram}
\end{equation*}
%end{example}


%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "../ctex"
%%% End: 
